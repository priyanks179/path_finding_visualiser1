(()=>{"use strict";const e=class{constructor(e,s,l){this.x=e,this.y=s,this.maze=l,this.cellId=t(e,s),this.wall=!1,this.nbrs=this.getNbrs(e,s),this.prev=null,this.f=Number.MAX_VALUE-1e5,this.g=Number.MAX_VALUE-1e5,this.h=Number.MAX_VALUE-1e5}makeWall(e){this.x===this.maze.start_r&&this.y===this.maze.start_c||this.x===this.maze.target_r&&this.y===this.maze.target_c||(window.isMouseDown||"mousedown"===e.type)&&(this.wall?(this.wall=!1,document.getElementById(this.cellId).style.backgroundColor="wheat"):(this.wall=!0,document.getElementById(this.cellId).style.backgroundColor="black"))}getNbrs(e,s){let l=[],n=this.maze.r,i=this.maze.c;return e<n-1&&l.push(t(e+1,s)),s<i-1&&l.push(t(e,s+1)),e>0&&l.push(t(e-1,s)),s>0&&l.push(t(e,s-1)),l}reset(){this.wall=!1,this.f=Number.MAX_VALUE-1e5,this.g=Number.MAX_VALUE-1e5,this.h=Number.MAX_VALUE-1e5,document.getElementById(this.cellId).style.backgroundColor="#f5f5f5"}},t=(e,t)=>`${e}_${t}`,s=e=>{let t=e.split("_");return t[0]=Number(t[0]),t[1]=Number(t[1]),t};let l=1;window.fillColorTimer=10;const n=e=>{for(let t of e.keys())e.get(t).reset(),l=0},i=(e,t)=>{l++,setTimeout((()=>{document.getElementById(e).style.backgroundColor=t}),window.fillColorTimer*l)},r=()=>{let e=document.createElement("img");return e.setAttribute("id","start"),e.setAttribute("class","interactive_elem"),e.setAttribute("src","../images/start.png"),e.setAttribute("width","80%"),e.setAttribute("height","80%"),e},d=()=>{let e=document.createElement("img");return e.setAttribute("id","target"),e.setAttribute("class","interactive_elem"),e.setAttribute("src","../images/target.png"),e.setAttribute("width","80%"),e.setAttribute("height","80%"),e},o=s=>{let l=s.r,n=s.c,i=new Map;for(let r=0;r<l;r++)for(let l=0;l<n;l++){let n=t(r,l),d=new e(r,l,s);i.set(n,d),document.getElementById(n).addEventListener("mouseenter",(e=>d.makeWall(e))),document.getElementById(n).addEventListener("mousedown",(e=>d.makeWall(e))),document.getElementById(n).addEventListener("dragover",(e=>e.preventDefault())),document.getElementById(n).addEventListener("dragstart",(e=>{const t=e.target;e.dataTransfer.setData("text/plain",t.id),t.style.opacity="0"})),document.getElementById(n).addEventListener("drop",(e=>{let t=e.dataTransfer.getData("text"),l=document.getElementById(t),n=l.parentElement,r=e.target;if("start"===r.id||"target"===r.id)return l.style.opacity="1",void(window.isMouseDown=!1);n.removeChild(l),l.style.opacity="1",r.appendChild(l),r.style.backgroundColor="wheat";let d=i.get(r.id);1==d.wall&&(d.wall=!1),"start"===t?s.setStartPos(r.id):"target"===t&&s.setTargetPos(r.id),window.isMouseDown=!1}))}return i},a=function(e,t){let s=e.get("0_0"),l=s.maze.startCellId,n=s.maze.targetCellId,r=this.exploringColor,d=this.exploredColor,o=this.pathColor,a=[],m=new Set,u=!1;for(a.push(l),i(l,r);a.length>0;){let s;s="bfs"===t?a.shift():a.pop(),m.add(s);let l=e.get(s);i(s,d);let o=l.nbrs;for(let t of o){if(t===n){u=!0,i(n,r),e.get(n).prev=s;break}m.has(t)||e.get(t).wall||a.includes(t)||(a.push(t),i(t,r),e.get(t).prev=s)}if(!0===u)break}if(!1===u)return;let g=[],h=n;for(;null!=e.get(h);)g.push(h),h=e.get(h).prev;for(let e=g.length-1;e>0;e--){let t=g[e];i(t,o)}i(n,o)},m=(e,t)=>{let s=0,l=Number.MAX_VALUE;return e.forEach(((e,n)=>{let i=t.get(e).f;i<l&&(l=i,s=n)})),[e.splice(s,1)[0],e]},u=(e,t)=>{let l=0,n=0,i=0,r=0;return[l,n]=s(e),[i,r]=s(t),(Math.abs(l-i)**2+Math.abs(n-r)**2)**.5},g=function(e,t){let s=e.get("0_0"),l=s.maze.startCellId,n=s.maze.targetCellId,r=this.exploringColor,d=this.exploredColor,o=this.pathColor,a=[],g=new Set,h=!1;for(a.push(l),e.get(l).g=0,e.get(l).h="dijkstra"===t?0:u(l,n),e.get(l).f=e.get(l).h,i(l,r);a.length>0;){let s=0;[s,a]=m(a,e),g.add(s),i(s,d);let l=e.get(s),o=l.nbrs;for(let d of o){if(d===n){h=!0,i(n,r),e.get(n).prev=s;break}if(g.has(d)||e.get(d).wall)continue;let o=l.g+1;o<e.get(d).g&&(e.get(d).prev=s,e.get(d).g=o,e.get(d).h="dijkstra"===t?0:u(d,n),e.get(d).f=e.get(d).g+e.get(d).h,!1===a.includes(d)&&(i(d,r),a.push(d)))}if(h)break}if(!1===h)return;let c=[],y=n;for(;null!=e.get(y);)c.push(y),y=e.get(y).prev;for(let e=c.length-1;e>0;e--){let t=c[e];i(t,o)}i(n,o)},h=(e,t)=>{let s=document.createElement("div");s.setAttribute("id","canvas"),s.setAttribute("style","border-style:solid; border-width:thin; background-color:#f5f5f5; width:100%; height:100%;"),document.getElementById("main").appendChild(s);let l=e,n=t,i=String(100/n)+"%",r=String(100/l)+"%",d=document.createElement("div");d.setAttribute("style",`width:100%; height:${r}; display:flex;`);let o=document.createElement("div");o.setAttribute("style",`width: ${i}; height: 100%;  border-width: thin;\n         border-style: solid; display:flex; justify-content: center; align-items: center;`);for(let e=0;e<l;e++){let t=d.cloneNode(!0);for(let s=0;s<n;s++){let l=o.cloneNode(!0);l.setAttribute("id",`${e}_${s}`),t.appendChild(l)}s.appendChild(t)}window.isMouseDown=!1,document.getElementsByTagName("body")[0].addEventListener("mousedown",(()=>{window.isMouseDown=!0})),document.getElementsByTagName("body")[0].addEventListener("mouseup",(()=>{window.isMouseDown=!1}))},c=class{constructor(e,s){this.r=e,this.c=s,this.start_r=0,this.start_c=0,this.target_r=e-1,this.target_c=s-1,this.startCellId=t(this.start_r,this.start_c),this.targetCellId=t(this.target_r,this.target_c),this.addIcon(this.startCellId,r),this.addIcon(this.targetCellId,d)}addIcon(e,t){document.getElementById(e).appendChild(t())}setStartPos(e){let t=s(e);this.start_c=t[1],this.start_r=t[0],this.startCellId=e}setTargetPos(e){let t=s(e);this.target_c=t[1],this.target_r=t[0],this.targetCellId=e}};new class{constructor(){this.rows=25,this.cols=25,h(this.rows,this.cols),this.maze=new c(this.rows,this.cols),this.grid=o(this.maze),this.algoHandler=new class{constructor(e){this.exploringColor="green",this.exploredColor="red",this.pathColor="blue",this.grid=e}run(e){return"bfs"===e||"dfs"===e?a.bind(this,this.grid,""+e):"dijkstra"===e||"astar"===e?g.bind(this,this.grid,""+e):void 0}setGrid(e){this.grid=e}}(this.grid),this.setRowCOlMenu("row"),this.setRowCOlMenu("col"),this.setAlgoMenu(),this.setSpeedMenu(),this.reset()}setText(e,t){document.getElementById(e).innerHTML=t}setRowCOlMenu(e="row"){let t="row"===e?3:4;for(let s=15;s<31;s++){let l=document.createElement("li");l.setAttribute("id",`${e}${s}`),l.setAttribute("class",e+"Menu"),l.innerHTML=s,document.getElementById(`menu${t}lst`).appendChild(l),document.getElementById(`${e}${s}`).onclick=()=>{document.getElementById(`noof${e}s`).innerHTML=""+s,document.getElementById(`menu${t}lst`).style.display="none",3===t?this.rows=s:this.cols=s,document.getElementById("main").removeChild(document.getElementById("canvas")),h(this.rows,this.cols),this.maze=new c(this.rows,this.cols),this.grid=o(this.maze),this.algoHandler.setGrid(this.grid),this.setAlgoMenu()}}document.getElementById(`menu${t}lstHeading`).addEventListener("mouseenter",(()=>{document.getElementById(`menu${t}lst`).style.display="block"})),document.getElementById(`menu${t}lstHeading`).addEventListener("mouseleave",(()=>{document.getElementById(`menu${t}lst`).style.display="none"}))}setAlgoMenu(){document.getElementById("visualize").onclick=this.algoHandler.run("bfs"),this.setText("algoName","Visualizing Bfs");for(let e of document.getElementsByClassName("algoMenu"))e.addEventListener("click",(e=>{let t=e.target.id,s=e.target.innerText;document.getElementById("visualize").onclick=this.algoHandler.run(t),this.setText("algoName","Visualizing "+s),document.getElementById("menu1lst").style.display="none"}));document.getElementById("menu1lstHeading").addEventListener("mouseenter",(()=>{document.getElementById("menu1lst").style.display="block",document.getElementById("menu1lst").style.zIndex="10"})),document.getElementById("menu1lstHeading").addEventListener("mouseleave",(()=>{document.getElementById("menu1lst").style.display="none"}))}setSpeedMenu(){for(let e of document.getElementsByClassName("speedMenu"))e.addEventListener("click",(e=>{let t=e.target.id,s=e.target.innerText;this.setText("speedName",s),"slow"===t?window.fillColorTimer=15:"average"===t?window.fillColorTimer=10:"fast"===t&&(window.fillColorTimer=5),document.getElementById("menu2lst").style.display="none"}));document.getElementById("menu2lstHeading").addEventListener("mouseenter",(()=>{document.getElementById("menu2lst").style.display="block"})),document.getElementById("menu2lstHeading").addEventListener("mouseleave",(()=>{document.getElementById("menu2lst").style.display="none"}))}reset(){document.getElementById("reset").addEventListener("click",(()=>{n.bind(this,this.grid)()}))}}})();